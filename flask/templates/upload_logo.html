{% extends "base.html" %}
{% block title %}Logo hochladen{% endblock %}
{% block content %}

<section class="page-header">
	<h1 class="page-title">
		<i class="fas fa-image"></i>
		Logo hochladen
	</h1>
	<div class="page-actions">
		{% if session.name %}
			<span class="user-badge">
				<i class="fas fa-user"></i>
				Angemeldet als {{ session.name }}
			</span>
		{% endif %}
		<form action="/s_all" method="get" class="inline">
			<button type="submit" class="btn btn-outline">
				<i class="fas fa-arrow-left"></i>
				Zurück
			</button>
		</form>
	</div>
</section>

{% if success_message %}
<div class="notice success">
	<i class="fas fa-check-circle"></i>
	<span>{{ success_message }}</span>
</div>
{% endif %}

{% if error_message %}
<div class="notice danger">
	<i class="fas fa-exclamation-triangle"></i>
	<span>{{ error_message }}</span>
</div>
{% endif %}

<section class="card form-card">
	<div class="card-header">
		<h3 class="card-title">
			<i class="fas fa-upload"></i>
			Logo hochladen
		</h3>
	</div>
	
	<form action="#" method="post" enctype="multipart/form-data" class="form" id="uploadForm">
		<div class="form-section">
			<div class="form-field">
				<label class="label" for="logo_file">
					<i class="fas fa-file-image"></i>
					Logo-Datei auswählen
				</label>
				<input class="input" type="file" name="logo_file" id="logo_file" accept="image/*,.svg" required />
				<small style="color: #a0aec0; margin-top: 0.5rem; display: block;">
					<i class="fas fa-info-circle"></i>
					Erlaubte Formate: PNG, JPG, JPEG, GIF, SVG, WEBP (max. 5MB)
				</small>
			</div>
		</div>
		
		<div class="form-footer">
			<button type="submit" class="save-btn btn-primary">
				<i class="fas fa-upload"></i>
				Hochladen
			</button>
		</div>
	</form>
</section>

<section class="card form-card">
	<div class="card-header">
		<h3 class="card-title">
			<i class="fas fa-ruler"></i>
			Logo-Größe anpassen
		</h3>
	</div>
	
	<form action="/set_logo_size" method="post" class="form">
		<div class="form-section">
			<div class="form-field">
				<label class="label">
					<i class="fas fa-expand-arrows-alt"></i>
					Aktuelle Größe: <strong>Breite: {{ logo_width }}, Höhe: {{ logo_height }}</strong>
				</label>
				<div style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 1rem; align-items: end; margin-top: 0.5rem;">
					<div>
						<label for="logo_width" style="display: block; margin-bottom: 0.5rem; color: #a0aec0; font-size: 0.875rem;">
							<i class="fas fa-arrows-alt-h"></i>
							Breite
						</label>
						<input class="input" type="text" name="width" id="logo_width" value="{{ logo_width }}" placeholder="z.B. auto, 100px, 3rem" />
					</div>
					<div>
						<label for="logo_height" style="display: block; margin-bottom: 0.5rem; color: #a0aec0; font-size: 0.875rem;">
							<i class="fas fa-arrows-alt-v"></i>
							Höhe
						</label>
						<input class="input" type="text" name="height" id="logo_height" value="{{ logo_height }}" placeholder="z.B. 2.5rem, 40px" />
					</div>
					<button type="submit" class="btn btn-primary">
						<i class="fas fa-save"></i>
						Speichern
					</button>
				</div>
				<small style="color: #a0aec0; margin-top: 0.5rem; display: block;">
					<i class="fas fa-info-circle"></i>
					Geben Sie Breite und Höhe ein (z.B. "auto" oder "100px" für Breite, "2.5rem" für Höhe). Standard: Breite: auto, Höhe: 2.5rem
				</small>
			</div>
		</div>
	</form>
</section>

<section class="card form-card">
	<div class="card-header">
		<h3 class="card-title">
			<i class="fas fa-list"></i>
			Hochgeladene Logos
		</h3>
	</div>
	{% if uploaded_logos and uploaded_logos|length > 0 %}
	<div class="uploaded-files-list">
		{% for logo in uploaded_logos %}
		<div class="uploaded-file-item" style="display: flex; align-items: center; justify-content: space-between; padding: 1rem; border-bottom: 1px solid #2d3748;">
			<div class="file-info" style="display: flex; align-items: center; gap: 1rem; flex: 1;">
					<div style="width: 60px; height: 60px; border: 1px solid #2d3748; border-radius: 4px; display: flex; align-items: center; justify-content: center; overflow: hidden; background: #1a202c;">
						<img src="{{ url_for('static', filename=logo.path) }}" alt="{{ logo.filename }}" style="max-width: 100%; max-height: 100%; object-fit: contain;" />
					</div>
				<div>
					<div style="font-weight: 600; color: #e2e8f0; margin-bottom: 0.25rem;">{{ logo.filename }}</div>
					<div style="font-size: 0.875rem; color: #a0aec0;">
						<i class="fas fa-calendar"></i>
						{{ logo.date.strftime('%d.%m.%Y %H:%M') }}
						<span style="margin-left: 1rem;">
							<i class="fas fa-file"></i>
							{{ "%.2f"|format(logo.size / 1024) }} KB
						</span>
					</div>
				</div>
			</div>
			<div class="file-actions" style="display: flex; gap: 0.5rem; align-items: center;">
				{% if logo.is_active %}
				<span class="badge-active" style="background: #48bb78; color: white; padding: 0.25rem 0.75rem; border-radius: 4px; font-size: 0.875rem; font-weight: 600;">
					<i class="fas fa-check-circle"></i>
					Aktives Logo
				</span>
				{% endif %}
				<a href="{{ url_for('static', filename=logo.path) }}" target="_blank" class="btn btn-outline" style="padding: 0.5rem 1rem;">
					<i class="fas fa-eye"></i>
					Ansehen
				</a>
				{% if not logo.is_active %}
				<form action="/set_active_logo/{{ logo.filename }}" method="post" style="display: inline;">
					<button type="submit" class="btn btn-primary" style="padding: 0.5rem 1rem;">
						<i class="fas fa-check"></i>
						Als Logo setzen
					</button>
				</form>
				{% endif %}
				<form action="/delete_logo/{{ logo.filename }}" method="post" style="display: inline;" onsubmit="return confirm('Möchten Sie dieses Logo wirklich löschen?');">
					<button type="submit" class="btn btn-outline" style="padding: 0.5rem 1rem; color: #fc8181;">
						<i class="fas fa-trash"></i>
						Löschen
					</button>
				</form>
			</div>
		</div>
		{% endfor %}
	</div>
	{% else %}
	<div style="padding: 2rem; text-align: center; color: #a0aec0;">
		<i class="fas fa-image" style="font-size: 3rem; opacity: 0.3; margin-bottom: 1rem;"></i>
		<p>Noch keine Logos hochgeladen.</p>
	</div>
	{% endif %}
</section>

<style>
/* Logo upload form styles */
.form-field input[type="number"] {
	width: 100%;
}
</style>

<script>
// Handle form submission - validate file
document.getElementById('uploadForm').addEventListener('submit', function(e) {
	const fileInput = document.getElementById('logo_file');
	if (!fileInput.files || fileInput.files.length === 0) {
		e.preventDefault();
		alert('Bitte wählen Sie eine Datei aus.');
		return false;
	}
});
</script>

{% endblock %}

